/*
 * -------------------------------------------------
 *  Low Memory Configuration Profile
 * -------------------------------------------------
 * Configuration for memory-constrained environments
 * (laptops, desktops, small servers with 32-64GB RAM)
 *
 * Key optimizations:
 * - Reduced max_memory from 128GB to 32GB
 * - Reduced max_cpus from 16 to 8
 * - Enables parallel cluster processing with Canu process_low optimization
 * - Constrains process_high to avoid memory exhaustion
 */

params {
  max_memory = 32.GB
  max_cpus = 8
  max_time = 240.h
}

process {
  // Override process_high to prevent memory exhaustion on low-memory systems
  // With default process_high (12 CPU, 84GB), only 1 cluster could run at a time
  // With this override (4 CPU, 28GB), we can run 1 cluster at a time safely
  withLabel:process_high {
    cpus = { check_max( 4 * task.attempt, 'cpus' ) }
    memory = { check_max( 28.GB * task.attempt, 'memory' ) }
    time = { check_max( 10.h * task.attempt, 'time' ) }
  }

  // Override process_medium to be more conservative
  withLabel:process_medium {
    cpus = { check_max( 4 * task.attempt, 'cpus' ) }
    memory = { check_max( 21.GB * task.attempt, 'memory' ) }
    time = { check_max( 8.h * task.attempt, 'time' ) }
  }

  // process_low stays the same (2 CPU, 14GB) - defined in base.config
  // This allows 2 clusters to run in parallel on 32GB systems
}
